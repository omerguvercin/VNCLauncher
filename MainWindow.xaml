<Window x:Class="VNCLauncher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VNCLauncher"
        xmlns:tb="http://www.hardcodet.net/taskbar"
        xmlns:helpers="clr-namespace:VNCLauncher.Helpers"
        mc:Ignorable="d"
        Title="VNC Launcher" Height="500" Width="650" WindowStartupLocation="CenterScreen"
        Icon="VNC.ico"
        KeyDown="Window_KeyDown">
    
    <Window.Resources>
        <helpers:BoolToColorConverter x:Key="BoolToColorConverter"/>
        
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#DDDDDD"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,5,0,10"/>
        </Style>
        
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        
        <Style x:Key="AddButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#4CAF50"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Content" Value="+"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        
        <Style x:Key="DeleteButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#F44336"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Content" Value="-"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        
        <Style x:Key="EditButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Content" Value="✎"/>
            <Setter Property="FontSize" Value="18"/>
        </Style>

        <!-- Modern DataGrid Stilleri -->
        <Style x:Key="ModernDataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#DDE2E6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#E8EDF0"/>
            <Setter Property="VerticalGridLinesBrush" Value="Transparent"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="RowHeight" Value="36"/>
            <Setter Property="AlternatingRowBackground" Value="#F7F9FA"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
        </Style>

        <Style x:Key="ModernDataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#F1F3F5"/>
            <Setter Property="Foreground" Value="#495057"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#DDE2E6"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>

        <Style x:Key="ModernDataGridCellStyle" TargetType="DataGridCell">
            <Setter Property="Padding" Value="0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Padding="10,5"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                            <ContentPresenter VerticalAlignment="Center" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="FontSize" Value="13"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#D0EFFF"/>
                    <Setter Property="Foreground" Value="#0078D4"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ModernDataGridRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="Transparent"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E9F5FD"/>
                </Trigger>
                 <Trigger Property="AlternationIndex" Value="0">
                    <Setter Property="Background" Value="White" />
                </Trigger>
                <Trigger Property="AlternationIndex" Value="1">
                    <Setter Property="Background" Value="#F7F9FA" />
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                     <Setter Property="Background" Value="#CCEBFB"/>
                     <Setter Property="Foreground" Value="#212529"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Modern ComboBox Style -->
        <Style x:Key="ModernComboBoxStyle" TargetType="{x:Type ComboBox}">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <ToggleButton Grid.Column="2"
                                          ClickMode="Press"
                                          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="3">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <ContentPresenter Grid.Column="0"
                                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                                  Margin="{TemplateBinding Padding}"/>
                                                <Path Grid.Column="1"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      Margin="0,0,6,0"
                                                      Fill="{TemplateBinding Foreground}"
                                                      Data="M0,0 L4,4 L8,0 Z"/>
                                            </Grid>
                                        </Border>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                              Margin="{TemplateBinding Padding}"/>
                            <Popup x:Name="PART_Popup"
                                   AllowsTransparency="True"
                                   IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                   PopupAnimation="{StaticResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}"
                                   Placement="Bottom">
                                <Border BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Background="{TemplateBinding Background}"
                                        CornerRadius="3">
                                    <ScrollViewer>
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocusWithin" Value="True">
                                <Setter Property="BorderBrush" Value="#2196F3"/>
                            </Trigger>
                            <Trigger Property="IsDropDownOpen" Value="True">
                                <Setter TargetName="PART_Popup" Property="IsOpen" Value="True"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Tray Icon -->
        <tb:TaskbarIcon x:Name="TrayIcon"
                      ToolTipText="VNC Launcher"
                      IconSource="/VNC.ico"
                      MenuActivation="RightClick"
                      TrayMouseDoubleClick="TrayIcon_TrayMouseDoubleClick">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Göster" Click="ShowMenuItem_Click"/>
                    <MenuItem Header="Hızlı Bağlantı..." Click="QuickConnectMenuItem_Click"/>
                    <Separator />
                    <MenuItem Header="Çıkış" Click="ExitMenuItem_Click"/>
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
        </tb:TaskbarIcon>
        
        <!-- Tab Control -->
        <TabControl x:Name="tabControl" Grid.Row="1" Margin="10,10,10,10" VerticalAlignment="Stretch">
            <TabItem Header="Adres Defteri">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Butonlar ve Arama Kutusu -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,10,0,10">
                        <Button x:Name="btnAdd" Style="{StaticResource AddButton}" Click="BtnAdd_Click" ToolTip="Yeni Bağlantı Ekle"/>
                        <Button x:Name="btnDelete" Style="{StaticResource DeleteButton}" Click="BtnDelete_Click" ToolTip="Seçili Bağlantıyı Sil"/>
                        <Button x:Name="btnEdit" Style="{StaticResource EditButton}" Click="BtnEdit_Click" ToolTip="Seçili Bağlantıyı Düzenle"/>
                        <TextBlock Text="Ara:" VerticalAlignment="Center" Margin="20,0,5,0" Foreground="#555"/>
                        <TextBox x:Name="txtSearchConnections" Width="200" Style="{StaticResource ModernTextBox}" TextChanged="TxtSearchConnections_TextChanged" VerticalAlignment="Center" Margin="0,0,0,0"/>
                        <ComboBox x:Name="cmbConnectionFilter" Width="120" Height="32" Margin="10,0,0,0" VerticalAlignment="Center"
                                  FontSize="13"
                                  Padding="5,5"
                                  BorderBrush="#CCCCCC"
                                  BorderThickness="1"
                                  Background="White"
                                  Foreground="#333"
                                  SelectionChanged="CmbConnectionFilter_SelectionChanged">
                            <ComboBoxItem Content="Tümü" IsSelected="True"/>
                            <ComboBoxItem Content="Erişilebilenler"/>
                            <ComboBoxItem Content="Erişilemeyenler"/>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- Bağlantı Listesi -->
                    <DataGrid Grid.Row="1" x:Name="dgConnections" 
                              Style="{StaticResource ModernDataGridStyle}"
                              ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}"
                              CellStyle="{StaticResource ModernDataGridCellStyle}"
                              RowStyle="{StaticResource ModernDataGridRowStyle}"
                              MouseDoubleClick="DgConnections_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Bağlantı Adı" Binding="{Binding Name}" Width="*" IsReadOnly="True"/>
                            <DataGridTextColumn Header="IP Adresi" Binding="{Binding IpAddress}" Width="*" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Son Bağlantı" Binding="{Binding LastConnected, StringFormat='dd.MM.yyyy HH:mm'}" Width="*" IsReadOnly="True"/>
                            <DataGridTemplateColumn Header="Favori" Width="Auto" SortMemberPath="IsFavorite">
                                <DataGridTemplateColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ModernDataGridColumnHeaderStyle}">
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTemplateColumn.HeaderStyle>
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsFavorite, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" 
                                                  HorizontalAlignment="Center" 
                                                  VerticalAlignment="Center" 
                                                  Click="FavoriteCheckBox_Click">
                                            <CheckBox.Style>
                                                <Style TargetType="CheckBox">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="CheckBox">
                                                                <Grid Background="Transparent">
                                                                    <TextBlock Text="☆" FontSize="18" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="LightGray" Visibility="Visible" Name="StarUnchecked"/>
                                                                    <TextBlock Text="★" FontSize="18" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Gold" Visibility="Collapsed" Name="StarChecked"/>
                                                                </Grid>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsChecked" Value="True">
                                                                        <Setter TargetName="StarUnchecked" Property="Visibility" Value="Collapsed"/>
                                                                        <Setter TargetName="StarChecked" Property="Visibility" Value="Visible"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </CheckBox.Style>
                                        </CheckBox>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTemplateColumn Header="Durum" Width="Auto" IsReadOnly="True">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Ellipse Width="10" Height="10">
                                            <Ellipse.Style>
                                                <Style TargetType="Ellipse">
                                                    <Setter Property="Fill" Value="{Binding IsAvailable, Converter={StaticResource BoolToColorConverter}}"/>
                                                </Style>
                                            </Ellipse.Style>
                                        </Ellipse>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            
            <TabItem x:Name="tabScan" Header="Tarama">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Margin="0,5,0,2" BorderBrush="#DDDDDD" BorderThickness="1" Padding="10,5,10,5">
                        <StackPanel>
                            <TextBlock Text="Ağ Tarama Ayarları" FontWeight="Bold" FontSize="16" Foreground="#333333" Margin="0,0,0,5"/>
                            <Grid Margin="0,0,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="IP Aralığı (örn: 192.168.1.1-254):" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBox x:Name="txtIpRange" Grid.Column="1" Style="{StaticResource ModernTextBox}" Margin="0,0,0,0" PreviewTextInput="IpRangeTextBox_PreviewTextInput" TextChanged="IpRangeTextBox_TextChanged"/>
                                <Button x:Name="btnScanNetwork" Grid.Column="2" Content="Ağı Tara" Margin="15,0,0,0" Padding="15,8" Click="BtnScanNetwork_Click" Background="#3498DB" Foreground="White" BorderThickness="0" Cursor="Hand">
                                    <Button.Resources>
                                        <Style TargetType="Border">
                                            <Setter Property="CornerRadius" Value="4"/>
                                        </Style>
                                    </Button.Resources>
                                </Button>
                            </Grid>
                            <ProgressBar x:Name="scanProgressBar" Height="8" Margin="0,5,0,0" Visibility="Collapsed"/>
                            <TextBlock x:Name="txtScanStatus" TextWrapping="Wrap" Margin="0,2,0,0" FontSize="11" Foreground="#555555"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Row="1" Grid.RowSpan="2" Background="White" CornerRadius="8" BorderBrush="#DDDDDD" BorderThickness="1" Margin="0,5,0,5">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#F8F9FA" BorderThickness="0,0,0,1" BorderBrush="#EEEEEE" Padding="10,8,10,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Bulunan Cihazlar" FontWeight="SemiBold" FontSize="14" Foreground="#333333" VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1" x:Name="txtSelectedCount" Text="0 öğe seçildi" Margin="15,0,0,0" VerticalAlignment="Center" Foreground="#666666"/>
                                    <Button Grid.Column="2" x:Name="btnAddSelectedToAddressBook" Click="BtnAddSelectedToAddressBook_Click" Background="#2ECC71" Foreground="White" Padding="15,8" Margin="0,0,0,0" BorderThickness="0" Cursor="Hand">
                                        <Button.Resources>
                                            <Style TargetType="Border">
                                                <Setter Property="CornerRadius" Value="4"/>
                                            </Style>
                                        </Button.Resources>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <Path Width="14" Height="14" Margin="0,0,8,0" Fill="White" Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" Stretch="Uniform"/>
                                            <TextBlock Text="Seçilenleri Ekle" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </Border>
                            <DataGrid Grid.Row="1" x:Name="dgScanResults" AutoGenerateColumns="False" IsReadOnly="False" SelectionMode="Extended" Style="{StaticResource ModernDataGridStyle}" ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeaderStyle}" CellStyle="{StaticResource ModernDataGridCellStyle}" RowStyle="{StaticResource ModernDataGridRowStyle}" Margin="0" BorderThickness="0" Background="White" ContextMenu="{StaticResource ScanResultContextMenu}">
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Width="40">
                                        <DataGridTemplateColumn.HeaderTemplate>
                                            <DataTemplate>
                                                <CheckBox x:Name="headerCheckBox" Checked="HeaderCheckBox_Checked" Unchecked="HeaderCheckBox_Unchecked"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.HeaderTemplate>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="IP Adresi" Binding="{Binding IpAddress}" Width="*">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Padding" Value="10,5"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Hostname" Binding="{Binding Hostname}" Width="*">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Padding" Value="10,5"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Hostname}" Value="{x:Null}">
                                                        <Setter Property="Text" Value="Bilinmiyor"/>
                                                        <Setter Property="FontStyle" Value="Italic"/>
                                                        <Setter Property="Foreground" Value="#999999"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
            
            <TabItem Header="Ayarlar">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Ayarlar Bölümü -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Margin="0,10,0,5"
                            BorderBrush="#DDDDDD" BorderThickness="1" Padding="20">
                        <StackPanel>
                            <TextBlock Text="Program Ayarları" FontWeight="Bold" FontSize="18" Foreground="#333333" Margin="0,0,0,15"/>
                            
                            <!-- TightVNC Yolu -->
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,15,0" VerticalAlignment="Center">
                                    <Path Width="20" Height="20" Margin="0,0,8,0" Fill="#2196F3" 
                                          Data="M5,3L4.35,6.34H17.94L17.5,8.5H3.92L3.26,11.83H16.85L16.09,15.64L10.61,17.45L5.86,15.64L6.19,14H2.85L2.06,18L9.91,21L18.96,18L20.16,11.97L20.4,10.76L21.94,3H5Z" 
                                          Stretch="Uniform" />
                                    <TextBlock Text="TightVNC Yolu:" VerticalAlignment="Center" FontWeight="SemiBold" />
                                </StackPanel>
                                
                                <TextBox Grid.Column="1" x:Name="txtVncPath" Padding="8,5" BorderThickness="1" BorderBrush="#CCCCCC" VerticalAlignment="Center"/>
                                <Button Grid.Column="2" Content="Gözat" Click="BtnBrowse_Click" Margin="10,0,0,0" Padding="10,5"/>
                            </Grid>
                            
                            <!-- VNC Port Numarası -->
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,15,0" VerticalAlignment="Center">
                                    <Path Width="20" Height="20" Margin="0,0,8,0" Fill="#FF9800" 
                                          Data="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12.5,7H11V12.5L16.25,15.3L17,14.05L12.5,11.5V7Z" 
                                          Stretch="Uniform" />
                                    <TextBlock Text="VNC Portu:" VerticalAlignment="Center" FontWeight="SemiBold" />
                                </StackPanel>
                                
                                <TextBox Grid.Column="1" x:Name="txtVncPort" Padding="8,5" BorderThickness="1" BorderBrush="#CCCCCC" VerticalAlignment="Center" PreviewTextInput="TxtVncPort_PreviewTextInput"/>
                            </Grid>
                            
                            <!-- Windows Başlangıcı -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                <Path Width="20" Height="20" Margin="0,0,8,0" Fill="#2ECC71"
                                      Data="M12,16L19.36,10.27L21,9L12,2L3,9L4.63,10.27M12,18.54L4.62,12.81L3,14.07L12,21.07L21,14.07L19.37,12.8L12,18.54Z"
                                      Stretch="Uniform" />
                                <CheckBox x:Name="chkStartWithWindows" Content="Windows ile birlikte başlat" 
                                          VerticalAlignment="Center" FontWeight="SemiBold" />
                            </StackPanel>
                            
                            <!-- Kaydet Butonu -->
                            <Button HorizontalAlignment="Left" Margin="0,5,0,0" Padding="20,10" 
                                    Click="BtnSaveSettings_Click" Background="#2ECC71" Foreground="White" 
                                    BorderThickness="0" Cursor="Hand">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="4" />
                                    </Style>
                                </Button.Resources>
                                <StackPanel Orientation="Horizontal">
                                    <Path Width="16" Height="16" Margin="0,0,8,0" Fill="White" 
                                          Data="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" 
                                          Stretch="Uniform" />
                                    <TextBlock Text="Ayarları Kaydet"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                    
                    <!-- Bağımlılık Kontrol Sonucu -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" Margin="0,5,0,10"
                            BorderBrush="#DDDDDD" BorderThickness="1" Padding="20">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Başlık -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                                <Path Width="24" Height="24" Margin="0,0,10,0" Fill="#FF9800" 
                                      Data="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12.5,7H11V12.5L16.25,15.3L17,14.05L12.5,11.5V7Z" 
                                      Stretch="Uniform" />
                                <TextBlock Text="Bağımlılık Kontrolü" FontWeight="Bold" FontSize="18" Foreground="#333333"/>
                            </StackPanel>
                            
                            <!-- Durum Bilgisi -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Height="60">
                                <StackPanel>
                                    <TextBlock x:Name="txtDependencyStatus" TextWrapping="Wrap" 
                                              Margin="0,2" FontSize="12" Foreground="#555555"/>
                                    <TextBlock x:Name="txtDotNetStatus" TextWrapping="Wrap" 
                                              Margin="0,2" FontSize="12" Foreground="#555555"/>
                                </StackPanel>
                            </ScrollViewer>
                            
                            <!-- İndir Butonu -->
                            <Button Grid.Row="2" x:Name="btnInstallVnc" Content="TightVNC İndir" 
                                   Visibility="Collapsed" HorizontalAlignment="Left" Margin="0,15,0,0" 
                                   Padding="20,10" Click="BtnInstallVnc_Click"
                                   Background="#FF9800" Foreground="White" BorderThickness="0" 
                                   Cursor="Hand">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="4" />
                                    </Style>
                                </Button.Resources>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
            
            <TabItem Header="Yardım">
                <Grid Margin="10">
                    <Border Background="White" CornerRadius="8" Margin="0,10,0,10"
                            BorderBrush="#DDDDDD" BorderThickness="1" Padding="20">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <TextBlock Text="VNC Launcher Hakkında" FontWeight="Bold" FontSize="20" Foreground="#333333" Margin="0,0,0,15"/>
                                
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                    <Path Width="24" Height="24" Margin="0,0,10,0" Fill="#2196F3" 
                                          Data="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M11,16.5L18,9.5L16.59,8.09L11,13.67L7.91,10.59L6.5,12L11,16.5Z" 
                                          Stretch="Uniform" />
                                    <TextBlock Text="Kullanım" FontWeight="Bold" FontSize="16" Foreground="#333333"/>
                                </StackPanel>
                                
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,20" Foreground="#555555">
                                    <Bold>Kullanım:</Bold> Program başlatıldığında sistem tepsisinde simge olarak görünür. Simgeye çift tıklandığında adres defteri arayüzü açılır. Kayıtlı bağlantılara çift tıklandığında TightVNC Viewer ile bağlantı kurulur.
                                    <LineBreak/>
                                    <Bold>Ayarlar Sekmesi:</Bold> TightVNC Viewer programının yolu ve varsayılan VNC bağlantı portu bu sekmeden ayarlanabilir. Ayrıca, uygulamanın Windows ile birlikte başlayıp başlamayacağı da buradan kontrol edilebilir.
                                    <LineBreak/>
                                    <Bold>Tarama Sekmesi:</Bold> Ağ üzerindeki VNC sunucularını taramak için kullanılır. IP aralığı belirtilerek (örn: 192.168.1.1-254) tarama yapılabilir. Bulunan cihazlar listelenir ve adres defterine eklenebilir.
                                </TextBlock>
                                
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                    <Path Width="24" Height="24" Margin="0,0,10,0" Fill="#E91E63" 
                                          Data="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M11,16.5L18,9.5L16.59,8.09L11,13.67L7.91,10.59L6.5,12L11,16.5Z" 
                                          Stretch="Uniform" />
                                    <TextBlock Text="Gereksinimler" FontWeight="Bold" FontSize="16" Foreground="#333333"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,0,20">
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,5" Foreground="#555555">
                                        • TightVNC Viewer - 
                                        <Hyperlink NavigateUri="https://www.tightvnc.com/download.php" RequestNavigate="Hyperlink_RequestNavigate">
                                            https://www.tightvnc.com/download.php
                                        </Hyperlink>
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,5" Foreground="#555555">
                                        • .NET 8.0 Runtime - 
                                        <Hyperlink NavigateUri="https://dotnet.microsoft.com/en-us/download/dotnet/8.0" RequestNavigate="Hyperlink_RequestNavigate">
                                            https://dotnet.microsoft.com/en-us/download/dotnet/8.0
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>
                                
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                    <Path Width="24" Height="24" Margin="0,0,10,0" Fill="#4CAF50" 
                                          Data="M12,3A9,9 0 0,0 3,12H0L4,16L8,12H5A7,7 0 0,1 12,5A7,7 0 0,1 19,12A7,7 0 0,1 12,19C10.5,19 9.09,18.5 7.94,17.7L6.5,19.14C8.04,20.3 9.94,21 12,21A9,9 0 0,0 21,12A9,9 0 0,0 12,3M14,12A2,2 0 0,0 12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12Z" 
                                          Stretch="Uniform" />
                                    <TextBlock Text="İletişim" FontWeight="Bold" FontSize="16" Foreground="#333333"/>
                                </StackPanel>
                                
                                <StackPanel Margin="0,0,0,5">
                                    <TextBlock TextWrapping="Wrap" Margin="0,0,0,10" Foreground="#555555">
                                        <Bold>Geliştirici:</Bold> omerguvercin
                                    </TextBlock>
                                     <TextBlock TextWrapping="Wrap" Foreground="#555555">
                                        <Bold>Facebook:</Bold> 
                                        <Hyperlink NavigateUri="https://fb.com/iOmerG" RequestNavigate="Hyperlink_RequestNavigate">
                                            fb.com/iOmerG
                                        </Hyperlink>
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" Foreground="#555555" Margin="0,0,0,5">
                                        <Bold>GitHub:</Bold> 
                                        <Hyperlink NavigateUri="   https://github.com/omerguvercin" RequestNavigate="Hyperlink_RequestNavigate">
                                            github.com/omerguvercin
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabItem>
            
            <TabItem x:Name="ExitTab" Header="Çıkış">
                <Grid Background="White">
                    <Border Background="White" CornerRadius="8" Margin="10" 
                            BorderBrush="#DDDDDD" BorderThickness="1" Padding="20">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="Uygulamayı Kapatmak İstiyor musunuz?" 
                                      FontWeight="Bold" FontSize="18" Foreground="#333333" 
                                      HorizontalAlignment="Center" Margin="0,0,0,20"/>
                            
                            <Button Content="Uygulamayı Kapat" Width="200" Height="50" 
                                   Click="BtnExit_Click" Background="#F44336" 
                                   Foreground="White" BorderThickness="0" Cursor="Hand">
                                <Button.Resources>
                                    <Style TargetType="Border">
                                        <Setter Property="CornerRadius" Value="4" />
                                    </Style>
                                </Button.Resources>
                            </Button>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
